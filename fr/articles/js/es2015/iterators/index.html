<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="stylesheet" href="/statinamic-client.css" /><meta data-react-helmet="true" property="og:site_name" content="Putain de code !"/><meta data-react-helmet="true" name="twitter:site" content="@putaindecode_fr"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="ES6, ES2015 : le protocole d&#x27;itération"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="ES6, ES2015 : le protocole d&#x27;itération"/><meta data-react-helmet="true" name="twitter:creator" content="@ffesseler"/><title data-react-helmet="true">ES6, ES2015 : le protocole d&#x27;itération</title></head><body><div id="statinamic"><div id="statinamic-container" data-reactid=".50i4badxc0" data-react-checksum="-310537469"><div class="r-VerticalRhythm" lang="fr" data-reactid=".50i4badxc0.0"><div data-reactid=".50i4badxc0.0.0"><noscript data-reactid=".50i4badxc0.0.0.0:0"></noscript><div class="putainde-Header" data-reactid=".50i4badxc0.0.0.0:1"><div class="r-Grid" data-reactid=".50i4badxc0.0.0.0:1.0"><div class="r-Grid-cell r-minM--1of3" data-reactid=".50i4badxc0.0.0.0:1.0.0"><a class="putainde-SiteTitle" href="/" data-reactid=".50i4badxc0.0.0.0:1.0.0.0"><span class="SVGIcon SVGIcon--cleaned putainde-Logo" data-reactid=".50i4badxc0.0.0.0:1.0.0.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="-49.5 652.5 512 512"><radialGradient id="a" cx="206.455" cy="-395.01" r="243.791" gradientTransform="matrix(.9784 0 0 -.9765 4.504 505.604)" gradientUnits="userSpaceOnUse"><stop offset=".8"/><stop offset=".95" stop-color="#333"/></radialGradient><linearGradient id="b" gradientUnits="userSpaceOnUse" x1="-34" y1="-376.331" x2="447" y2="-376.331" gradientTransform="matrix(1 0 0 -1 0 515)"><stop offset="0" stop-color="#333"/><stop offset="1"/></linearGradient><path vector-effect="non-scaling-stroke" opacity=".4" fill="url(#a)" stroke="url(#b)" stroke-miterlimit="10" d="M-33.5,891.331c0-130.655,107.456-236.581,240.01-236.581c132.535,0,239.99,105.927,239.99,236.581 c0,130.653-107.455,236.581-239.99,236.581C73.956,1127.911-33.5,1021.984-33.5,891.331z"/><linearGradient id="c" gradientUnits="userSpaceOnUse" x1="-34.5" y1="-377.169" x2="447.5" y2="-377.169" gradientTransform="matrix(1 0 0 -1 0 515)"><stop offset="0" stop-color="#333"/><stop offset="1"/></linearGradient><path opacity=".2" fill="none" stroke="url(#c)" stroke-width="2" stroke-miterlimit="10" d="M-33.5,892.169c0-130.655,107.456-236.581,240.01-236.581c132.535,0,239.99,105.928,239.99,236.581 c0,130.654-107.455,236.581-239.99,236.581C73.956,1128.75-33.5,1022.824-33.5,892.169z"/><g><linearGradient id="d" gradientUnits="userSpaceOnUse" x1="30.247" y1="427.851" x2="30.247" y2="228.319" gradientTransform="matrix(2.3906 0 0 -2.3906 134.192 1708.07)"><stop offset="0" stop-color="#FFF"/><stop offset="1" stop-color="#EEE"/></linearGradient><path vector-effect="non-scaling-stroke" fill="url(#d)" stroke="#7A7A7A" stroke-miterlimit="10" d="M1,889.671c0,112.916,92.003,204.444,205.51,204.444c1.283,0,2.565-0.019,3.828-0.04c19.795,40.379,61.281,68.175,109.258,68.175 c3.686,0,7.334-0.157,10.941-0.481c-20.401-23.875-33.307-54.348-35.07-87.771C364.424,1041.018,412,970.873,412,889.673 c0-112.894-92.004-204.423-205.49-204.423C93.004,685.247,1,776.777,1,889.671z"/><path fill="none" stroke="#7A7A7A" stroke-width="2" stroke-miterlimit="10" d="M1,889.671 c0,112.916,92.003,204.444,205.51,204.444c1.283,0,2.565-0.019,3.828-0.04c19.795,40.379,61.281,68.175,109.258,68.175 c3.686,0,7.334-0.157,10.941-0.481c-20.401-23.875-33.307-54.348-35.07-87.771C364.424,1041.018,412,970.873,412,889.673 c0-112.894-92.004-204.423-205.49-204.423C93.004,685.247,1,776.777,1,889.671z"/></g><g stroke="#333333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"><path vector-effect="non-scaling-stroke" fill="#444444" d="M187.747,832.25H132.5v123h27.551v-45.188h28.086c7.596,0,14.055-1.102,19.378-3.302c5.323-2.196,9.656-5.138,13.019-8.745 c3.364-3.605,5.801-7.795,7.327-12.498c1.527-4.707,2.312-9.494,2.312-14.363c0-4.978-0.785-9.807-2.312-14.428 c-1.567-4.625-4.024-8.789-7.387-12.396c-3.363-3.605-7.765-6.551-13.168-8.747C201.924,833.391,195.421,832.25,187.747,832.25z M181.225,889.979h-21.173v-37.641h21.173c3.096,0,6.107,0.227,8.996,0.704c2.891,0.478,5.428,1.411,7.635,2.738 c2.187,1.346,3.941,3.274,5.285,5.698c1.319,2.463,1.979,5.679,1.979,9.682s-0.66,7.253-1.979,9.68 c-1.344,2.486-3.1,4.395-5.285,5.742c-2.207,1.327-4.744,2.236-7.635,2.695C187.334,889.753,184.32,889.979,181.225,889.979z"/><path fill="none" stroke-width="2" d="M187.747,832.25H132.5v123h27.551v-45.188h28.086c7.596,0,14.055-1.102,19.378-3.302c5.323-2.196,9.656-5.138,13.019-8.745 c3.364-3.605,5.801-7.795,7.327-12.498c1.527-4.707,2.312-9.494,2.312-14.363c0-4.978-0.785-9.807-2.312-14.428 c-1.567-4.625-4.024-8.789-7.387-12.396c-3.363-3.605-7.765-6.551-13.168-8.747C201.924,833.391,195.421,832.25,187.747,832.25z M181.225,889.979h-21.173v-37.641h21.173c3.096,0,6.107,0.227,8.996,0.704c2.891,0.478,5.428,1.411,7.635,2.738 c2.187,1.346,3.941,3.274,5.285,5.698c1.319,2.463,1.979,5.679,1.979,9.682s-0.66,7.253-1.979,9.68 c-1.344,2.486-3.1,4.395-5.285,5.742c-2.207,1.327-4.744,2.236-7.635,2.695C187.334,889.753,184.32,889.979,181.225,889.979z"/><g><path vector-effect="non-scaling-stroke" fill="#444444" d="M247.616,944.686c0,9.709,7.241,17.064,17.44,17.064c10.202,0,17.442-7.357,17.442-17.064c0-9.25-7.24-16.328-17.441-16.328 C254.855,927.592,247.616,934.95,247.616,944.686z M280.201,881.346V831.75h-30.292v49.596l6.886,37.639h16.521L280.201,881.346z"/><path fill="none" stroke-width="2" d="M247.616,944.686c0,9.709,7.241,17.064,17.44,17.064c10.202,0,17.442-7.357,17.442-17.064c0-9.25-7.24-16.328-17.441-16.328 C254.855,927.592,247.616,934.95,247.616,944.686z M280.201,881.346V831.75h-30.292v49.596l6.886,37.639h16.521L280.201,881.346z"/></g></g><g><linearGradient id="e" gradientUnits="userSpaceOnUse" x1="87.136" y1="385.394" x2="87.136" y2="297.549" gradientTransform="matrix(2.3906 0 0 -2.3906 134.192 1708.07)"><stop offset="0" stop-color="#c5372f"/><stop offset="1" stop-color="#900"/></linearGradient><path vector-effect="non-scaling-stroke" fill="url(#e)" stroke="#8B2721" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M314.164,970.195c2.755,0,4.955-0.561,6.592-1.577c1.639-1.095,2.916-2.451,3.854-4.009c0.923-1.614,1.519-3.43,1.758-5.362 c0.22-1.996,0.382-3.806,0.382-5.465v-36.5c0-4.823,0.895-8.829,2.715-11.96c1.818-3.09,3.978-5.622,6.469-7.516 c2.48-1.873,5.058-3.27,7.773-4.106c2.733-0.818,4.952-1.354,6.706-1.496v-0.697c-1.756-0.139-3.973-0.598-6.706-1.356 c-2.718-0.735-5.293-2.111-7.773-3.984c-2.491-1.895-4.648-4.564-6.469-7.994c-1.82-3.408-2.715-7.936-2.715-13.574v-34.669 c0-1.812-0.162-3.706-0.382-5.661c-0.239-1.955-0.837-3.769-1.758-5.363c-0.938-1.574-2.218-2.93-3.854-3.986 s-3.837-1.613-6.592-1.613H302.5V786.75h28.781c2.694,0,5.753,0.676,9.169,1.953c3.414,1.316,6.632,3.25,9.591,5.762 c2.953,2.532,5.449,5.741,7.53,9.669c2.036,3.927,3.112,8.472,3.112,13.695v43.299c0,3.849,0.742,7.118,2.299,9.788 c1.56,2.691,3.417,4.844,5.614,6.459c2.157,1.615,4.875,2.751,7.392,3.43c2.496,0.678,4.652,1.016,6.512,1.016v20.076 c-1.857,0-4.016,0.379-6.512,1.058c-2.517,0.677-5.232,1.772-7.394,3.209c-2.195,1.455-4.055,3.429-5.612,5.88 c-1.557,2.453-2.299,5.423-2.299,8.932v44.697c0,5.2-1.076,9.771-3.112,13.696c-2.079,3.927-4.577,7.116-7.532,9.688 c-2.955,2.487-6.175,4.402-9.589,5.74c-3.416,1.275-6.475,1.954-9.169,1.954H302.5v-26.554L314.164,970.195L314.164,970.195 L314.164,970.195z"/><path fill="none" stroke="#8B2721" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M314.164,970.195c2.755,0,4.955-0.561,6.592-1.577c1.639-1.095,2.916-2.451,3.854-4.009c0.923-1.614,1.519-3.43,1.758-5.362 c0.22-1.996,0.382-3.806,0.382-5.465v-36.5c0-4.823,0.895-8.829,2.715-11.96c1.818-3.09,3.978-5.622,6.469-7.516 c2.48-1.873,5.058-3.27,7.773-4.106c2.733-0.818,4.952-1.354,6.706-1.496v-0.697c-1.756-0.139-3.973-0.598-6.706-1.356 c-2.718-0.735-5.293-2.111-7.773-3.984c-2.491-1.895-4.648-4.564-6.469-7.994c-1.82-3.408-2.715-7.936-2.715-13.574v-34.669 c0-1.812-0.162-3.706-0.382-5.661c-0.239-1.955-0.837-3.769-1.758-5.363c-0.938-1.574-2.218-2.93-3.854-3.986 s-3.837-1.613-6.592-1.613H302.5V786.75h28.781c2.694,0,5.753,0.676,9.169,1.953c3.414,1.316,6.632,3.25,9.591,5.762 c2.953,2.532,5.449,5.741,7.53,9.669c2.036,3.927,3.112,8.472,3.112,13.695v43.299c0,3.849,0.742,7.118,2.299,9.788 c1.56,2.691,3.417,4.844,5.614,6.459c2.157,1.615,4.875,2.751,7.392,3.43c2.496,0.678,4.652,1.016,6.512,1.016v20.076 c-1.857,0-4.016,0.379-6.512,1.058c-2.517,0.677-5.232,1.772-7.394,3.209c-2.195,1.455-4.055,3.429-5.612,5.88 c-1.557,2.453-2.299,5.423-2.299,8.932v44.697c0,5.2-1.076,9.771-3.112,13.696c-2.079,3.927-4.577,7.116-7.532,9.688 c-2.955,2.487-6.175,4.402-9.589,5.74c-3.416,1.275-6.475,1.954-9.169,1.954H302.5v-26.554L314.164,970.195L314.164,970.195 L314.164,970.195z"/><g><linearGradient id="f" gradientUnits="userSpaceOnUse" x1="-26.642" y1="385.394" x2="-26.642" y2="297.55" gradientTransform="matrix(2.3906 0 0 -2.3906 134.192 1708.07)"><stop offset="0" stop-color="#c5372f"/><stop offset="1" stop-color="#900"/></linearGradient><path vector-effect="non-scaling-stroke" fill="url(#f)" stroke="#8B2721" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M98.835,813.305c-2.797,0-4.995,0.56-6.632,1.615c-1.618,1.057-2.916,2.413-3.815,3.987c-0.958,1.596-1.559,3.409-1.778,5.362 c-0.24,1.955-0.339,3.848-0.339,5.664V864.6c0,5.642-0.958,10.166-2.776,13.576c-1.818,3.43-3.975,6.1-6.432,7.993 c-2.496,1.874-5.073,3.25-7.811,3.985c-2.716,0.759-4.914,1.217-6.671,1.355v0.697c1.758,0.141,3.955,0.678,6.671,1.495 c2.737,0.838,5.314,2.233,7.811,4.106c2.456,1.895,4.614,4.426,6.432,7.517c1.817,3.13,2.776,7.136,2.776,11.96v36.501 c0,1.651,0.101,3.466,0.339,5.463c0.22,1.931,0.818,3.748,1.778,5.362c0.899,1.555,2.197,2.908,3.815,4.006 c1.637,1.021,3.835,1.58,6.632,1.58H110.5v26.552H81.716c-2.716,0-5.792-0.676-9.208-1.954c-3.396-1.337-6.592-3.251-9.548-5.74 c-2.937-2.574-5.493-5.762-7.531-9.688c-2.077-3.929-3.097-8.496-3.097-13.701v-44.692c0-3.51-0.798-6.479-2.357-8.933 c-1.558-2.449-3.415-4.424-5.573-5.879c-2.198-1.437-5.154-2.531-7.65-3.209c-2.497-0.679-4.534-1.058-6.252-1.058V881.82 c1.718,0,3.755-0.338,6.252-1.016c2.497-0.68,5.453-1.813,7.65-3.431c2.158-1.615,4.015-3.769,5.573-6.459 c1.559-2.671,2.357-5.938,2.357-9.788v-43.299c0-5.225,1.019-9.77,3.097-13.695c2.038-3.927,4.595-7.137,7.531-9.669 c2.956-2.511,6.151-4.444,9.548-5.761c3.416-1.276,6.492-1.954,9.208-1.954H110.5v26.553L98.835,813.305L98.835,813.305z"/><path fill="none" stroke="#8B2721" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M98.835,813.305c-2.797,0-4.995,0.56-6.632,1.615c-1.618,1.057-2.916,2.413-3.815,3.987c-0.958,1.596-1.559,3.409-1.778,5.362 c-0.24,1.955-0.339,3.848-0.339,5.664V864.6c0,5.642-0.958,10.166-2.776,13.576c-1.818,3.43-3.975,6.1-6.432,7.993 c-2.496,1.874-5.073,3.25-7.811,3.985c-2.716,0.759-4.914,1.217-6.671,1.355v0.697c1.758,0.141,3.955,0.678,6.671,1.495 c2.737,0.838,5.314,2.233,7.811,4.106c2.456,1.895,4.614,4.426,6.432,7.517c1.817,3.13,2.776,7.136,2.776,11.96v36.501 c0,1.651,0.101,3.466,0.339,5.463c0.22,1.931,0.818,3.748,1.778,5.362c0.899,1.555,2.197,2.908,3.815,4.006 c1.637,1.021,3.835,1.58,6.632,1.58H110.5v26.552H81.716c-2.716,0-5.792-0.676-9.208-1.954c-3.396-1.337-6.592-3.251-9.548-5.74 c-2.937-2.574-5.493-5.762-7.531-9.688c-2.077-3.929-3.097-8.496-3.097-13.701v-44.692c0-3.51-0.798-6.479-2.357-8.933 c-1.558-2.449-3.415-4.424-5.573-5.879c-2.198-1.437-5.154-2.531-7.65-3.209c-2.497-0.679-4.534-1.058-6.252-1.058V881.82 c1.718,0,3.755-0.338,6.252-1.016c2.497-0.68,5.453-1.813,7.65-3.431c2.158-1.615,4.015-3.769,5.573-6.459 c1.559-2.671,2.357-5.938,2.357-9.788v-43.299c0-5.225,1.019-9.77,3.097-13.695c2.038-3.927,4.595-7.137,7.531-9.669 c2.956-2.511,6.151-4.444,9.548-5.761c3.416-1.276,6.492-1.954,9.208-1.954H110.5v26.553L98.835,813.305L98.835,813.305z"/></g></g></svg></span><span data-reactid=".50i4badxc0.0.0.0:1.0.0.0.1">Putain de code !</span></a></div><div class="r-Grid-cell r-minM--2of3" data-reactid=".50i4badxc0.0.0.0:1.0.1"><nav class="putainde-Nav" data-reactid=".50i4badxc0.0.0.0:1.0.1.0"><a class="putainde-Nav-item" href="/fr/articles" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.0:$/fr/articles"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.0:$/fr/articles.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M318.275,90v283.23L256,318.16l-62.275,55.07V90H318.275 M358.275,50H153.725v412L256,371.557	L358.275,462V50L358.275,50z"/></svg></span><span data-reactid=".50i4badxc0.0.0.0:1.0.1.0.0:$/fr/articles.1">Articles</span></a><a class="putainde-Nav-item" href="/fr/contribuer" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.0:$/fr/contribuer"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.0:$/fr/contribuer.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M74.686,340.686L50,460.949l122.365-22.584L379.52,231.211l-97.68-97.68L74.686,340.686z M303.088,205.032l-181.891,181.89l-21.213-21.213l181.891-181.89L303.088,205.032z M462,148.731l-52.662,52.662l-97.682-97.68	l52.662-52.663L462,148.731z"/></svg></span><span data-reactid=".50i4badxc0.0.0.0:1.0.1.0.0:$/fr/contribuer.1">Contribuer</span></a><a href="https://github.com/putaindecode/putaindecode.io" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="GitHub" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.1:$https=2//github=1com/putaindecode/putaindecode=1io"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.1:$https=2//github=1com/putaindecode/putaindecode=1io.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C197,349.352,195.265,350.583,193.125,350.583z"/></svg></span></a><a href="https://twitter.com/putaindecode_fr/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="Twitter" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.1:$https=2//twitter=1com/putaindecode_fr/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.1:$https=2//twitter=1com/putaindecode_fr/.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435	C436.339,160.061,450.668,145.174,462,128.223z"/></svg></span></a><a href="/discuss/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="Discuter" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.1:$/discuss/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:1.0.1.0.1:$/discuss/.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M174.059,354.374c-0.031-0.008-0.062-0.014-0.093-0.021	c-25.892,15.965-82.983,32.107-123.141,39.412c14.984-29.725,31.616-70.527,30.764-98.977C61.403,270.511,50,239.224,50,207.358	c0-89.84,87.383-155.527,185.209-155.527c97.22,0,185.211,65.193,185.211,155.527c0,1.283-0.027,2.564-0.066,3.844	c-11.285-6.088-23.506-11.037-36.622-14.68c-6.854-60.861-70.842-108.715-148.522-108.715c-82.237,0-149.141,53.631-149.141,119.551	c0,34.688,15.009,56.529,36.192,78.068c-4.306,31.98-14.646,59.781-14.646,59.781s30.542-8.064,65.253-28.275	C171.395,329.616,171.806,342.101,174.059,354.374z M461.432,460.169c-27.634-5.029-66.922-16.137-84.739-27.123	c-98.102,24.029-169.6-36.424-169.6-101.154c0-62.166,60.552-107.029,127.453-107.029c67.322,0,127.454,45.203,127.454,107.029	c0,21.928-7.85,43.457-21.738,60.164C439.674,411.634,451.121,439.712,461.432,460.169z M302.524,333.198	c0-9.648-7.841-17.469-17.515-17.469c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471	C294.684,350.669,302.524,342.847,302.524,333.198z M354.75,333.198c0-9.648-7.841-17.469-17.515-17.469	c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471C346.909,350.669,354.75,342.847,354.75,333.198z M406.339,333.198	c0-9.648-7.842-17.469-17.515-17.469c-9.674,0-17.515,7.82-17.515,17.469s7.841,17.471,17.515,17.471	C398.497,350.669,406.339,342.847,406.339,333.198z"/></svg></span></a></nav></div></div></div><div data-reactid=".50i4badxc0.0.0.0:2"><div class="putainde-Main" data-reactid=".50i4badxc0.0.0.0:2.3"><noscript data-reactid=".50i4badxc0.0.0.0:2.3.0"></noscript><article class="putainde-Post" data-reactid=".50i4badxc0.0.0.0:2.3.1"><header data-reactid=".50i4badxc0.0.0.0:2.3.1.0"><div class="putainde-Post-header" data-reactid=".50i4badxc0.0.0.0:2.3.1.0.0"><h1 class="putainde-Title" data-reactid=".50i4badxc0.0.0.0:2.3.1.0.0.2">ES6, ES2015 : le protocole d&#x27;itération</h1></div></header><div class="r-Grid" data-reactid=".50i4badxc0.0.0.0:2.3.1.1"><div class="r-Grid-cell r-minM--8of12 putainde-Post-contents" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0"><div class="putainde-Post-md" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.0"><div data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.0.0"><p>Imaginez un concept si important que si vous l’enleviez du langage, il faudrait
en conséquence enlever le spread, le destructuring, les générateurs, le for…of
et bien d’autres. Ce concept, introduit dans l’ES6, est en fait un protocole :
le protocole d’itération.</p>
<p>Le principe est de définir une convention dans le langage, qui permet de
standardiser la façon dont des sources de données peuvent être traversées.</p>
<p>Première bonne nouvelle, ce protocole est assez simple à comprendre et se base
sur 2 “interfaces” (oui les guillemets c’est pour dire qu’on ne parle pas
d’interface au sens technique, puisqu’elles n’existent pas en JS).</p>
<p>La première interface, appelée <strong>Iterator</strong> permet à un objet de produire des
valeurs en séquence. Un objet est un Iterator lorsqu’il implémente une
function <code>next()</code> qui retourne un objet avec 2 propriétés :</p>
<ul>
<li><code>value</code>: la valeur courante lors de l’itération</li>
<li><code>done</code> : un booléen qui indique si on a atteint la fin de l’itération ou non</li>
</ul>
<p>Les appels successifs à la méthode <code>next()</code> d’un Iterator permettent donc de
traverser et récupérer les valeurs d’un objet. Prenons l’exemple de l’Iterator
retourné par un Array qui contiendrait 2 valeurs (“a” et “b”) :</p>
<pre><code class="language-js">iteratorArray.next()
<span class="hljs-comment">// -&gt; Object {value: "a", done: false}</span>
iteratorArray.next()
<span class="hljs-comment">// -&gt; Object {value: "b", done: false}</span>
iteratorArray.next()
<span class="hljs-comment">// -&gt; Object {value: undefined, done: true}</span></code></pre>
<p>Mais comment récupérer l’Iterator d’un objet vas-tu me dire ? (n’est-ce pas ?)
Ça tombe bien, c’est le rôle de la seconde interface, appelée <strong>Iterable</strong>. Un
objet est Iterable s’il implémente une méthode particulière qui va retourner
l’Iterator. Cette méthode particulière (appelée <em>@@iterator</em> dans la
spécification) doit être définie en utilisant le symbole <code>[Symbol.iterator]</code>.
(Les symboles seront expliqués dans un prochain article, pas de panique).</p>
<p>En reprenant l’exemple précédent, voici comment récupérer l’Iterator d’un Array :</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>]
<span class="hljs-keyword">const</span> iteratorArray = arr[<span class="hljs-built_in">Symbol</span>.iterator]()
iteratorArray.next()
<span class="hljs-comment">// -&gt; Object {value: "a", done: false}</span>
iteratorArray.next()
<span class="hljs-comment">// -&gt; Object {value: "b", done: false}</span>
iteratorArray.next()
<span class="hljs-comment">// -&gt; Object {value: undefined, done: true}</span></code></pre>
<p>L’exemple ci-dessus illustre donc l’implémentation du protocole par l’Array.
Il n’est pas très utile en soi, en voici donc un autre qui va permettre de
boucler sur les valeurs et les afficher :</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>]
<span class="hljs-keyword">var</span> iterator = arr[<span class="hljs-built_in">Symbol</span>.iterator]()

<span class="hljs-keyword">var</span> result = iterator.next()
<span class="hljs-keyword">while</span> (!result.done) {
  <span class="hljs-built_in">console</span>.log(result.value)
  result = iterator.next()
}
<span class="hljs-comment">// 'a'</span>
<span class="hljs-comment">// 'b'</span></code></pre>
<p>De manière générale, quand un objet qui implémente le protocole d’itération est
traversé, sa méthode <em>@@iterator</em> est appelée (une seule fois donc) et l’Iterator
retourné est utilisé pour boucler sur ses valeurs.</p>
<h1 id="consommateurs-d-iterable"><a class="markdownIt-Anchor" href="#consommateurs-d-iterable">#</a> Consommateurs d’Iterable</h1>
<p>La deuxième bonne nouvelle, c’est que plusieurs concepts du langage tirent avantage de ce protocole :</p>
<ul>
<li>Certaines syntaxes s’attendent à recevoir des Iterables</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>]

<span class="hljs-comment">// La syntaxe à laquelle on pense immédiatement est la syntaxe « for .. of »</span>
<span class="hljs-comment">// qui permet de boucler sur les valeurs des Iterables.</span>
<span class="hljs-keyword">for</span> (val <span class="hljs-keyword">of</span> arr) {
    <span class="hljs-built_in">console</span>.log(val)
}

<span class="hljs-comment">// Le spread qui permet d'insérer facilement des valeurs dans un Array</span>
<span class="hljs-comment">// utilise également des Iterable</span>
[<span class="hljs-string">'0'</span>, ...arr, <span class="hljs-string">'1'</span>] <span class="hljs-comment">// 0, a, b, 1</span>

<span class="hljs-comment">// yield nécessite également des Iterable</span>
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">gen</span>(<span class="hljs-params"></span>)</span>{
  <span class="hljs-keyword">yield</span>* arr
}
gen().next() <span class="hljs-comment">// { value:"a", done:false }</span>

<span class="hljs-comment">// Le destructuring avec le pattern Array</span>
<span class="hljs-keyword">const</span> [x, y] = arr <span class="hljs-comment">// x = 'a',  y = "b"</span></code></pre>
<ul>
<li>Des API acceptent également des Iterables</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"b"</span>]

<span class="hljs-comment">// Certains constructeurs acceptent des Iterable</span>

<span class="hljs-comment">// Set et Weakset</span>
<span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(arr)
set.has(<span class="hljs-string">"b"</span>) <span class="hljs-comment">// true</span>
<span class="hljs-comment">// Map et WeakMap</span>
<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>(arr.entries()) <span class="hljs-comment">// Attention, le constructeur attend un ensemble [clé, valeur]</span>
map.get(<span class="hljs-number">0</span>) <span class="hljs-comment">// 'a'</span>


<span class="hljs-comment">// Ou encore les API suivants :</span>

<span class="hljs-built_in">Array</span>.from(iterable) <span class="hljs-comment">// transforme n'importe quel Iterable en Array.</span>
<span class="hljs-built_in">Promise</span>.all(iterableCollectionDePromises) <span class="hljs-comment">// n'importe quel Iterable qui contient un ensemble de Promises</span>
<span class="hljs-built_in">Promise</span>.race(iterableCollectionDePromises) <span class="hljs-comment">// idem</span></code></pre>
<h1 id="built-in-iterable"><a class="markdownIt-Anchor" href="#built-in-iterable">#</a> Built-in Iterable</h1>
<p>Troisième bonne nouvelle, plusieurs objets du langage implémentent déjà ce protocole :</p>
<pre><code class="language-js"><span class="hljs-comment">// évidemment les Array</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-string">"l"</span>, <span class="hljs-string">"o"</span>, <span class="hljs-string">"l"</span>]
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> arr) {
  <span class="hljs-built_in">console</span>.log(v)
  <span class="hljs-comment">// 'l'</span>
  <span class="hljs-comment">// 'o'</span>
  <span class="hljs-comment">// 'l'</span>
}

<span class="hljs-comment">// les String</span>
<span class="hljs-keyword">const</span> str = <span class="hljs-string">"lol"</span>
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> str) {
  <span class="hljs-built_in">console</span>.log(v)
  <span class="hljs-comment">// 'l'</span>
  <span class="hljs-comment">// 'o'</span>
  <span class="hljs-comment">// 'l'</span>
}

<span class="hljs-comment">// les Map et Set (mais PAS WeakMap et WeakSet)</span>
<span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>().set(<span class="hljs-string">'l'</span>, <span class="hljs-number">1</span>).set(<span class="hljs-string">'o'</span>, <span class="hljs-number">2</span>)
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> map) {
  <span class="hljs-built_in">console</span>.log(v)
  <span class="hljs-comment">// ["l", 1]</span>
  <span class="hljs-comment">// ["o", 2]</span>
}
<span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>().add(<span class="hljs-string">'l'</span>).add(<span class="hljs-string">'o'</span>)
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> map) {
  <span class="hljs-built_in">console</span>.log(v)
  <span class="hljs-comment">// 'l'</span>
  <span class="hljs-comment">// 'o'</span>
}

<span class="hljs-comment">// Les TypedArray que vous utilisez tous les jours</span>
<span class="hljs-keyword">const</span> int16 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Int16Array</span>(<span class="hljs-number">2</span>)
int16[<span class="hljs-number">0</span>] = <span class="hljs-number">42</span>
<span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> int16) {
  <span class="hljs-built_in">console</span>.log(v)
  <span class="hljs-comment">// 42</span>
  <span class="hljs-comment">// 0</span>
}

<span class="hljs-comment">// Même l'objet spécial arguments (que vous</span>
<span class="hljs-comment">// ne devriez plus utiliser avec l'ES6) est un Iterable</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> (v <span class="hljs-keyword">of</span> <span class="hljs-built_in">arguments</span>) {
    <span class="hljs-built_in">console</span>.log(v)
    <span class="hljs-comment">// 'l'</span>
    <span class="hljs-comment">// 'o'</span>
    <span class="hljs-comment">// 'l'</span>
  }
}
test(<span class="hljs-string">'l'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">'l'</span>)

<span class="hljs-comment">// Les NodeList retournés par l'API DOM également !</span>
<span class="hljs-keyword">const</span> matches = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'div'</span>)
<span class="hljs-keyword">for</span> (m <span class="hljs-keyword">of</span> matches) {
  <span class="hljs-built_in">console</span>.log(m)
  <span class="hljs-comment">// &lt;div id="topSection"&gt;</span>
  <span class="hljs-comment">// &lt;div id="brandLogo"&gt;</span>
  <span class="hljs-comment">// ...</span>
}</code></pre>
<p>Autre point : Array, TypedArray, Map, Set sont des Iterable mais définissent
aussi des méthodes qui retournent également des Iterable (ça va, vous suivez
toujours ?) :</p>
<ul>
<li>entries() retourne un ensemble des clés/valeurs</li>
<li>keys() retourne les clés</li>
<li>values() retourne les valeurs</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">for</span> (cleVals <span class="hljs-keyword">of</span> arr.entries()) {
  <span class="hljs-built_in">console</span>.log(cleVals)
  <span class="hljs-comment">// [0, "l"]</span>
  <span class="hljs-comment">// [1, "o"]</span>
  <span class="hljs-comment">// [2, "l"]</span>
}</code></pre>
<p>Détail important, <code>Object</code> n’est pas Iterable mais il n’est pas impossible de
voir apparaitre dans l’ES7 les méthodes entries(), keys() et values() sur
Object (cf.
<a href="https://github.com/tc39/proposal-object-values-entries">la proposition spec</a>).</p>
<h1 id="conclusion"><a class="markdownIt-Anchor" href="#conclusion">#</a> Conclusion</h1>
<p>J’espère que cet article a bien illustré l’importance de ce protocole dans le
langage. Nous avons vu ci-dessus que de nombreux concepts du langage tirent
déjà avantage de ce protocole mais il est au moins aussi important de noter que
cela permet d’établir une convention sur laquelle des librairies externes peuvent
s’appuyer.</p>
<p>Elles peuvent le faire de 2 manières :</p>
<ul>
<li>en proposant des sources de données qui implémentent le protocole (ex:
liste chaînée)</li>
<li>en tant que consommateur du protocole (ex: un algorithme de tri)</li>
</ul>
<h1 id="un-dernier-verre-pour-la-route"><a class="markdownIt-Anchor" href="#un-dernier-verre-pour-la-route">#</a> Un dernier verre pour la route</h1>
<p>Les articles suivants vous permettront d’aller encore plus loin dans le sujet. Vous y
apprendrez notamment qu’un iterator peut retourner en option 2 autres méthodes,
qu’un générateur est à la fois un Iterable et un Iterator, qu’un Iterable peut
être infini ou encore des exemples d’implémentations divers et variés :</p>
<ul>
<li><a href="http://www.2ality.com/2015/02/es6-iteration.html">Iterables and iterators in ECMAScript 6</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols">Iteration Protocols</a></li>
<li><a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/">ES6 in depth : iterators and the for of loop</a></li>
<li><a href="https://ponyfoo.com/articles/es6-iterators-in-depth">ES6 iterators in depth</a></li>
</ul>
<p>La pratique restant le meilleur moyen de se former, le site
<a href="http://es6katas.org/">ES6 Katas</a> est très bien fait pour s’exercer.</p>
</div></div><footer class="putainde-Post-footer" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1"><div data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0"><div class="putainde-Author undefined" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0"><a href="http://www.iobeya.com" class="putainde-Avatar putainde-Author-picture" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/653899?v=3&amp;s=128" alt="" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.0.0"/></a><div class="putainde-Author-description" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1"><div class="putainde-Author-title" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0"><h3 class="putainde-Author-name" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.0"><span class="putainde-WrittenBy" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.0.0">Écrit par </span><a class="putainde-Link" href="http://www.iobeya.com" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.0.1">ffesseler</a></h3><div class="putainde-Author-social" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1"><a href="http://www.iobeya.com" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Website" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M394.072,174.805l-47.916-48.023V88.472h47.916V174.805z M462,275.815h-42.508v166.213H92.508V275.815H50	L256,69.972L462,275.815z M296.847,271.972c-15.811-3.316-29.021,4.086-38.792,19.387c-9.771-15.301-22.98-22.703-38.789-19.387	c-36.746,10.876-36.336,69.543,38.582,113.047C332.908,341.761,333.59,282.848,296.847,271.972z"/></svg></span></a><a href="https://twitter.com/ffesseler" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Twitter" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1.1"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1.1.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435	C436.339,160.061,450.668,145.174,462,128.223z"/></svg></span></a><a href="https://github.com/ffesseler" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Github" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1.2"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.0.1.2.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C197,349.352,195.265,350.583,193.125,350.583z"/></svg></span></a></div></div><p class="putainde-Author-bio" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.1"><span data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.0.0.1.1.0">Pas bavard, surtout quand je code. D&#x27;ailleurs chut! je m&#x27;entends plus réfléchir</span></p></div></div></div><div class="putainde-Contributors" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2"><strong class="putainde-Contributors-label" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.0"><span data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.0.1">4 contributeurs sur cette page</span></strong><div class="r-Grid putainde-Contributors-actions" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1"><div class="r-Grid-cell r-all--1of3" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1.0"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.io/edit/master/content/fr/articles/js/es2015/iterators.md" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1.0.0">Modifier</a></div><div class="r-Grid-cell r-all--1of3" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1.1"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.io/blame/master/content/fr/articles/js/es2015/iterators.md" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1.1.0">Tracer les changements</a></div><div class="r-Grid-cell r-all--1of3" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1.2"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.io/commits/master/content/fr/articles/js/es2015/iterators.md" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.1.2.0">Historique</a></div></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="MoOx
(4 commits)" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:0"><a href="http://moox.io/" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:0.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/157534?v=3&amp;s=128" alt="" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:0.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="ffesseler
(2 commits)" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:1"><a href="http://www.iobeya.com" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:1.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/653899?v=3&amp;s=128" alt="" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:1.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="magsout
(1 commit)" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:2"><a href="http://magsout.github.io/" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:2.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1997108?v=3&amp;s=128" alt="" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:2.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="Macxim
(1 commit)" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:3"><a href="http://macx.im" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:3.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1909957?v=3&amp;s=128" alt="" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.1.2.2:3.0.0"/></a></div></div></footer><div data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2"><div id="disqus_thread" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.0"></div><noscript data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.1"><span data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.1.0"><span data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.1.0.0">Please enable JavaScript to view the</span><a href="http://disqus.com/?ref_noscript" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.1.0.1">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.2"><span data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.2.0">blog comments powered by</span><span class="logo-disqus" data-reactid=".50i4badxc0.0.0.0:2.3.1.1.0.2.2.1">Disqus</span></a></div></div></div></article></div></div><div class="putainde-Footer" data-reactid=".50i4badxc0.0.0.0:3"><div class="r-Grid" data-reactid=".50i4badxc0.0.0.0:3.0"><div class="r-Grid-cell r-minM--1of4" data-reactid=".50i4badxc0.0.0.0:3.0.0"><p class="putainde-Footer-text" data-reactid=".50i4badxc0.0.0.0:3.0.0.0">© 1970 - 2015 Putain de code !</p></div><div class="r-Grid-cell r-minM--2of4" data-reactid=".50i4badxc0.0.0.0:3.0.1"><ul class="putainde-Footer-list" data-reactid=".50i4badxc0.0.0.0:3.0.1.0"><li data-reactid=".50i4badxc0.0.0.0:3.0.1.0.0:$/feed=1xml"><a href="/feed.xml" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.0:$/feed=1xml.0">Flux RSS</a></li><li data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/forum/issues"><a href="https://github.com/putaindecode/forum/issues" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/forum/issues.0">Forum</a></li><li data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/putaindecode=1io"><a href="https://github.com/putaindecode/putaindecode.io" data-r-tooltip="GitHub" class="r-Tooltip r-Tooltip--top" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/putaindecode=1io.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/putaindecode=1io.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C197,349.352,195.265,350.583,193.125,350.583z"/></svg></span></a></li><li data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode_fr/"><a href="https://twitter.com/putaindecode_fr/" data-r-tooltip="Twitter" class="r-Tooltip r-Tooltip--top" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode_fr/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode_fr/.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435	C436.339,160.061,450.668,145.174,462,128.223z"/></svg></span></a></li><li data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$/discuss/"><a href="/discuss/" data-r-tooltip="Discuter" class="r-Tooltip r-Tooltip--top" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$/discuss/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".50i4badxc0.0.0.0:3.0.1.0.$/discuss/.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M174.059,354.374c-0.031-0.008-0.062-0.014-0.093-0.021	c-25.892,15.965-82.983,32.107-123.141,39.412c14.984-29.725,31.616-70.527,30.764-98.977C61.403,270.511,50,239.224,50,207.358	c0-89.84,87.383-155.527,185.209-155.527c97.22,0,185.211,65.193,185.211,155.527c0,1.283-0.027,2.564-0.066,3.844	c-11.285-6.088-23.506-11.037-36.622-14.68c-6.854-60.861-70.842-108.715-148.522-108.715c-82.237,0-149.141,53.631-149.141,119.551	c0,34.688,15.009,56.529,36.192,78.068c-4.306,31.98-14.646,59.781-14.646,59.781s30.542-8.064,65.253-28.275	C171.395,329.616,171.806,342.101,174.059,354.374z M461.432,460.169c-27.634-5.029-66.922-16.137-84.739-27.123	c-98.102,24.029-169.6-36.424-169.6-101.154c0-62.166,60.552-107.029,127.453-107.029c67.322,0,127.454,45.203,127.454,107.029	c0,21.928-7.85,43.457-21.738,60.164C439.674,411.634,451.121,439.712,461.432,460.169z M302.524,333.198	c0-9.648-7.841-17.469-17.515-17.469c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471	C294.684,350.669,302.524,342.847,302.524,333.198z M354.75,333.198c0-9.648-7.841-17.469-17.515-17.469	c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471C346.909,350.669,354.75,342.847,354.75,333.198z M406.339,333.198	c0-9.648-7.842-17.469-17.515-17.469c-9.674,0-17.515,7.82-17.515,17.469s7.841,17.471,17.515,17.471	C398.497,350.669,406.339,342.847,406.339,333.198z"/></svg></span></a></li></ul></div><div class="r-Grid-cell r-minM--1of4 putainde-Footer-text--right" data-reactid=".50i4badxc0.0.0.0:3.0.2"><span class="putainde-Footer-text putainde-Footer-text--small" data-reactid=".50i4badxc0.0.0.0:3.0.2.0"><a class="" href="/en/" data-reactid=".50i4badxc0.0.0.0:3.0.2.0.0">English</a><span data-reactid=".50i4badxc0.0.0.0:3.0.2.0.1"> | </span><a class="" href="/fr/" data-reactid=".50i4badxc0.0.0.0:3.0.2.0.2">Français</a></span></div></div></div><script data-reactid=".50i4badxc0.0.0.1"></script></div></div></div></div><script>window.__INITIAL_STATE__ = {"pages":{"fr/articles/js/es2015/iterators":{"head":{"layout":"Post","comments":true,"date":"2015-12-09","title":"ES6, ES2015 : le protocole d'itération","tags":["javascript","ES6","ES2015","iterators"],"authors":["ffesseler"]},"body":"<p>Imaginez un concept si important que si vous l’enleviez du langage, il faudrait\nen conséquence enlever le spread, le destructuring, les générateurs, le for…of\net bien d’autres. Ce concept, introduit dans l’ES6, est en fait un protocole :\nle protocole d’itération.</p>\n<p>Le principe est de définir une convention dans le langage, qui permet de\nstandardiser la façon dont des sources de données peuvent être traversées.</p>\n<p>Première bonne nouvelle, ce protocole est assez simple à comprendre et se base\nsur 2 “interfaces” (oui les guillemets c’est pour dire qu’on ne parle pas\nd’interface au sens technique, puisqu’elles n’existent pas en JS).</p>\n<p>La première interface, appelée <strong>Iterator</strong> permet à un objet de produire des\nvaleurs en séquence. Un objet est un Iterator lorsqu’il implémente une\nfunction <code>next()</code> qui retourne un objet avec 2 propriétés :</p>\n<ul>\n<li><code>value</code>: la valeur courante lors de l’itération</li>\n<li><code>done</code> : un booléen qui indique si on a atteint la fin de l’itération ou non</li>\n</ul>\n<p>Les appels successifs à la méthode <code>next()</code> d’un Iterator permettent donc de\ntraverser et récupérer les valeurs d’un objet. Prenons l’exemple de l’Iterator\nretourné par un Array qui contiendrait 2 valeurs (“a” et “b”) :</p>\n<pre><code class=\"language-js\">iteratorArray.next()\n<span class=\"hljs-comment\">// -&gt; Object {value: \"a\", done: false}</span>\niteratorArray.next()\n<span class=\"hljs-comment\">// -&gt; Object {value: \"b\", done: false}</span>\niteratorArray.next()\n<span class=\"hljs-comment\">// -&gt; Object {value: undefined, done: true}</span></code></pre>\n<p>Mais comment récupérer l’Iterator d’un objet vas-tu me dire ? (n’est-ce pas ?)\nÇa tombe bien, c’est le rôle de la seconde interface, appelée <strong>Iterable</strong>. Un\nobjet est Iterable s’il implémente une méthode particulière qui va retourner\nl’Iterator. Cette méthode particulière (appelée <em>@@iterator</em> dans la\nspécification) doit être définie en utilisant le symbole <code>[Symbol.iterator]</code>.\n(Les symboles seront expliqués dans un prochain article, pas de panique).</p>\n<p>En reprenant l’exemple précédent, voici comment récupérer l’Iterator d’un Array :</p>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">\"a\"</span>, <span class=\"hljs-string\">\"b\"</span>]\n<span class=\"hljs-keyword\">const</span> iteratorArray = arr[<span class=\"hljs-built_in\">Symbol</span>.iterator]()\niteratorArray.next()\n<span class=\"hljs-comment\">// -&gt; Object {value: \"a\", done: false}</span>\niteratorArray.next()\n<span class=\"hljs-comment\">// -&gt; Object {value: \"b\", done: false}</span>\niteratorArray.next()\n<span class=\"hljs-comment\">// -&gt; Object {value: undefined, done: true}</span></code></pre>\n<p>L’exemple ci-dessus illustre donc l’implémentation du protocole par l’Array.\nIl n’est pas très utile en soi, en voici donc un autre qui va permettre de\nboucler sur les valeurs et les afficher :</p>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">\"a\"</span>, <span class=\"hljs-string\">\"b\"</span>]\n<span class=\"hljs-keyword\">var</span> iterator = arr[<span class=\"hljs-built_in\">Symbol</span>.iterator]()\n\n<span class=\"hljs-keyword\">var</span> result = iterator.next()\n<span class=\"hljs-keyword\">while</span> (!result.done) {\n  <span class=\"hljs-built_in\">console</span>.log(result.value)\n  result = iterator.next()\n}\n<span class=\"hljs-comment\">// 'a'</span>\n<span class=\"hljs-comment\">// 'b'</span></code></pre>\n<p>De manière générale, quand un objet qui implémente le protocole d’itération est\ntraversé, sa méthode <em>@@iterator</em> est appelée (une seule fois donc) et l’Iterator\nretourné est utilisé pour boucler sur ses valeurs.</p>\n<h1 id=\"consommateurs-d-iterable\"><a class=\"markdownIt-Anchor\" href=\"#consommateurs-d-iterable\">#</a> Consommateurs d’Iterable</h1>\n<p>La deuxième bonne nouvelle, c’est que plusieurs concepts du langage tirent avantage de ce protocole :</p>\n<ul>\n<li>Certaines syntaxes s’attendent à recevoir des Iterables</li>\n</ul>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">\"a\"</span>, <span class=\"hljs-string\">\"b\"</span>]\n\n<span class=\"hljs-comment\">// La syntaxe à laquelle on pense immédiatement est la syntaxe « for .. of »</span>\n<span class=\"hljs-comment\">// qui permet de boucler sur les valeurs des Iterables.</span>\n<span class=\"hljs-keyword\">for</span> (val <span class=\"hljs-keyword\">of</span> arr) {\n    <span class=\"hljs-built_in\">console</span>.log(val)\n}\n\n<span class=\"hljs-comment\">// Le spread qui permet d'insérer facilement des valeurs dans un Array</span>\n<span class=\"hljs-comment\">// utilise également des Iterable</span>\n[<span class=\"hljs-string\">'0'</span>, ...arr, <span class=\"hljs-string\">'1'</span>] <span class=\"hljs-comment\">// 0, a, b, 1</span>\n\n<span class=\"hljs-comment\">// yield nécessite également des Iterable</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>* <span class=\"hljs-title\">gen</span>(<span class=\"hljs-params\"></span>)</span>{\n  <span class=\"hljs-keyword\">yield</span>* arr\n}\ngen().next() <span class=\"hljs-comment\">// { value:\"a\", done:false }</span>\n\n<span class=\"hljs-comment\">// Le destructuring avec le pattern Array</span>\n<span class=\"hljs-keyword\">const</span> [x, y] = arr <span class=\"hljs-comment\">// x = 'a',  y = \"b\"</span></code></pre>\n<ul>\n<li>Des API acceptent également des Iterables</li>\n</ul>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">\"a\"</span>, <span class=\"hljs-string\">\"b\"</span>, <span class=\"hljs-string\">\"b\"</span>]\n\n<span class=\"hljs-comment\">// Certains constructeurs acceptent des Iterable</span>\n\n<span class=\"hljs-comment\">// Set et Weakset</span>\n<span class=\"hljs-keyword\">const</span> set = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Set</span>(arr)\nset.has(<span class=\"hljs-string\">\"b\"</span>) <span class=\"hljs-comment\">// true</span>\n<span class=\"hljs-comment\">// Map et WeakMap</span>\n<span class=\"hljs-keyword\">const</span> map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Map</span>(arr.entries()) <span class=\"hljs-comment\">// Attention, le constructeur attend un ensemble [clé, valeur]</span>\nmap.get(<span class=\"hljs-number\">0</span>) <span class=\"hljs-comment\">// 'a'</span>\n\n\n<span class=\"hljs-comment\">// Ou encore les API suivants :</span>\n\n<span class=\"hljs-built_in\">Array</span>.from(iterable) <span class=\"hljs-comment\">// transforme n'importe quel Iterable en Array.</span>\n<span class=\"hljs-built_in\">Promise</span>.all(iterableCollectionDePromises) <span class=\"hljs-comment\">// n'importe quel Iterable qui contient un ensemble de Promises</span>\n<span class=\"hljs-built_in\">Promise</span>.race(iterableCollectionDePromises) <span class=\"hljs-comment\">// idem</span></code></pre>\n<h1 id=\"built-in-iterable\"><a class=\"markdownIt-Anchor\" href=\"#built-in-iterable\">#</a> Built-in Iterable</h1>\n<p>Troisième bonne nouvelle, plusieurs objets du langage implémentent déjà ce protocole :</p>\n<pre><code class=\"language-js\"><span class=\"hljs-comment\">// évidemment les Array</span>\n<span class=\"hljs-keyword\">const</span> arr = [<span class=\"hljs-string\">\"l\"</span>, <span class=\"hljs-string\">\"o\"</span>, <span class=\"hljs-string\">\"l\"</span>]\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> arr) {\n  <span class=\"hljs-built_in\">console</span>.log(v)\n  <span class=\"hljs-comment\">// 'l'</span>\n  <span class=\"hljs-comment\">// 'o'</span>\n  <span class=\"hljs-comment\">// 'l'</span>\n}\n\n<span class=\"hljs-comment\">// les String</span>\n<span class=\"hljs-keyword\">const</span> str = <span class=\"hljs-string\">\"lol\"</span>\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> str) {\n  <span class=\"hljs-built_in\">console</span>.log(v)\n  <span class=\"hljs-comment\">// 'l'</span>\n  <span class=\"hljs-comment\">// 'o'</span>\n  <span class=\"hljs-comment\">// 'l'</span>\n}\n\n<span class=\"hljs-comment\">// les Map et Set (mais PAS WeakMap et WeakSet)</span>\n<span class=\"hljs-keyword\">const</span> map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Map</span>().set(<span class=\"hljs-string\">'l'</span>, <span class=\"hljs-number\">1</span>).set(<span class=\"hljs-string\">'o'</span>, <span class=\"hljs-number\">2</span>)\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> map) {\n  <span class=\"hljs-built_in\">console</span>.log(v)\n  <span class=\"hljs-comment\">// [\"l\", 1]</span>\n  <span class=\"hljs-comment\">// [\"o\", 2]</span>\n}\n<span class=\"hljs-keyword\">const</span> set = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Set</span>().add(<span class=\"hljs-string\">'l'</span>).add(<span class=\"hljs-string\">'o'</span>)\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> map) {\n  <span class=\"hljs-built_in\">console</span>.log(v)\n  <span class=\"hljs-comment\">// 'l'</span>\n  <span class=\"hljs-comment\">// 'o'</span>\n}\n\n<span class=\"hljs-comment\">// Les TypedArray que vous utilisez tous les jours</span>\n<span class=\"hljs-keyword\">const</span> int16 = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Int16Array</span>(<span class=\"hljs-number\">2</span>)\nint16[<span class=\"hljs-number\">0</span>] = <span class=\"hljs-number\">42</span>\n<span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> int16) {\n  <span class=\"hljs-built_in\">console</span>.log(v)\n  <span class=\"hljs-comment\">// 42</span>\n  <span class=\"hljs-comment\">// 0</span>\n}\n\n<span class=\"hljs-comment\">// Même l'objet spécial arguments (que vous</span>\n<span class=\"hljs-comment\">// ne devriez plus utiliser avec l'ES6) est un Iterable</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">test</span>(<span class=\"hljs-params\"></span>) </span>{\n  <span class=\"hljs-keyword\">for</span> (v <span class=\"hljs-keyword\">of</span> <span class=\"hljs-built_in\">arguments</span>) {\n    <span class=\"hljs-built_in\">console</span>.log(v)\n    <span class=\"hljs-comment\">// 'l'</span>\n    <span class=\"hljs-comment\">// 'o'</span>\n    <span class=\"hljs-comment\">// 'l'</span>\n  }\n}\ntest(<span class=\"hljs-string\">'l'</span>, <span class=\"hljs-string\">'o'</span>, <span class=\"hljs-string\">'l'</span>)\n\n<span class=\"hljs-comment\">// Les NodeList retournés par l'API DOM également !</span>\n<span class=\"hljs-keyword\">const</span> matches = <span class=\"hljs-built_in\">document</span>.querySelectorAll(<span class=\"hljs-string\">'div'</span>)\n<span class=\"hljs-keyword\">for</span> (m <span class=\"hljs-keyword\">of</span> matches) {\n  <span class=\"hljs-built_in\">console</span>.log(m)\n  <span class=\"hljs-comment\">// &lt;div id=\"topSection\"&gt;</span>\n  <span class=\"hljs-comment\">// &lt;div id=\"brandLogo\"&gt;</span>\n  <span class=\"hljs-comment\">// ...</span>\n}</code></pre>\n<p>Autre point : Array, TypedArray, Map, Set sont des Iterable mais définissent\naussi des méthodes qui retournent également des Iterable (ça va, vous suivez\ntoujours ?) :</p>\n<ul>\n<li>entries() retourne un ensemble des clés/valeurs</li>\n<li>keys() retourne les clés</li>\n<li>values() retourne les valeurs</li>\n</ul>\n<pre><code class=\"language-js\"><span class=\"hljs-keyword\">for</span> (cleVals <span class=\"hljs-keyword\">of</span> arr.entries()) {\n  <span class=\"hljs-built_in\">console</span>.log(cleVals)\n  <span class=\"hljs-comment\">// [0, \"l\"]</span>\n  <span class=\"hljs-comment\">// [1, \"o\"]</span>\n  <span class=\"hljs-comment\">// [2, \"l\"]</span>\n}</code></pre>\n<p>Détail important, <code>Object</code> n’est pas Iterable mais il n’est pas impossible de\nvoir apparaitre dans l’ES7 les méthodes entries(), keys() et values() sur\nObject (cf.\n<a href=\"https://github.com/tc39/proposal-object-values-entries\">la proposition spec</a>).</p>\n<h1 id=\"conclusion\"><a class=\"markdownIt-Anchor\" href=\"#conclusion\">#</a> Conclusion</h1>\n<p>J’espère que cet article a bien illustré l’importance de ce protocole dans le\nlangage. Nous avons vu ci-dessus que de nombreux concepts du langage tirent\ndéjà avantage de ce protocole mais il est au moins aussi important de noter que\ncela permet d’établir une convention sur laquelle des librairies externes peuvent\ns’appuyer.</p>\n<p>Elles peuvent le faire de 2 manières :</p>\n<ul>\n<li>en proposant des sources de données qui implémentent le protocole (ex:\nliste chaînée)</li>\n<li>en tant que consommateur du protocole (ex: un algorithme de tri)</li>\n</ul>\n<h1 id=\"un-dernier-verre-pour-la-route\"><a class=\"markdownIt-Anchor\" href=\"#un-dernier-verre-pour-la-route\">#</a> Un dernier verre pour la route</h1>\n<p>Les articles suivants vous permettront d’aller encore plus loin dans le sujet. Vous y\napprendrez notamment qu’un iterator peut retourner en option 2 autres méthodes,\nqu’un générateur est à la fois un Iterable et un Iterator, qu’un Iterable peut\nêtre infini ou encore des exemples d’implémentations divers et variés :</p>\n<ul>\n<li><a href=\"http://www.2ality.com/2015/02/es6-iteration.html\">Iterables and iterators in ECMAScript 6</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols\">Iteration Protocols</a></li>\n<li><a href=\"https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/\">ES6 in depth : iterators and the for of loop</a></li>\n<li><a href=\"https://ponyfoo.com/articles/es6-iterators-in-depth\">ES6 iterators in depth</a></li>\n</ul>\n<p>La pratique restant le meilleur moyen de se former, le site\n<a href=\"http://es6katas.org/\">ES6 Katas</a> est très bien fait pour s’exercer.</p>\n","rawBody":"\nImaginez un concept si important que si vous l’enleviez du langage, il faudrait\nen conséquence enlever le spread, le destructuring, les générateurs, le for…of\net bien d’autres. Ce concept, introduit dans l’ES6, est en fait un protocole :\nle protocole d’itération.\n\nLe principe est de définir une convention dans le langage, qui permet de\nstandardiser la façon dont des sources de données peuvent être traversées.\n\nPremière bonne nouvelle, ce protocole est assez simple à comprendre et se base\nsur 2 \"interfaces\" (oui les guillemets c’est pour dire qu’on ne parle pas\nd’interface au sens technique, puisqu’elles n’existent pas en JS).\n\nLa première interface, appelée **Iterator** permet à un objet de produire des\nvaleurs en séquence. Un objet est un Iterator lorsqu’il implémente une\nfunction ``next()`` qui retourne un objet avec 2 propriétés :\n\n* ``value``: la valeur courante lors de l'itération\n* ``done`` : un booléen qui indique si on a atteint la fin de l’itération ou non\n\nLes appels successifs à la méthode ``next()`` d’un Iterator permettent donc de\ntraverser et récupérer les valeurs d’un objet. Prenons l’exemple de l’Iterator\nretourné par un Array qui contiendrait 2 valeurs (\"a\" et \"b\") :\n\n```js\niteratorArray.next()\n// -> Object {value: \"a\", done: false}\niteratorArray.next()\n// -> Object {value: \"b\", done: false}\niteratorArray.next()\n// -> Object {value: undefined, done: true}\n```\n\nMais comment récupérer l’Iterator d’un objet vas-tu me dire ? (n’est-ce pas ?)\nÇa tombe bien, c’est le rôle de la seconde interface, appelée **Iterable**. Un\nobjet est Iterable s’il implémente une méthode particulière qui va retourner\nl'Iterator. Cette méthode particulière (appelée *@@iterator* dans la\nspécification) doit être définie en utilisant le symbole ``[Symbol.iterator]``.\n(Les symboles seront expliqués dans un prochain article, pas de panique).\n\nEn reprenant l’exemple précédent, voici comment récupérer l’Iterator d’un Array :\n\n```js\nconst arr = [\"a\", \"b\"]\nconst iteratorArray = arr[Symbol.iterator]()\niteratorArray.next()\n// -> Object {value: \"a\", done: false}\niteratorArray.next()\n// -> Object {value: \"b\", done: false}\niteratorArray.next()\n// -> Object {value: undefined, done: true}\n```\n\nL’exemple ci-dessus illustre donc l’implémentation du protocole par l’Array.\nIl n’est pas très utile en soi, en voici donc un autre qui va permettre de\nboucler sur les valeurs et les afficher :\n\n```js\nconst arr = [\"a\", \"b\"]\nvar iterator = arr[Symbol.iterator]()\n\nvar result = iterator.next()\nwhile (!result.done) {\n  console.log(result.value)\n  result = iterator.next()\n}\n// 'a'\n// 'b'\n```\n\nDe manière générale, quand un objet qui implémente le protocole d’itération est\ntraversé, sa méthode *@@iterator* est appelée (une seule fois donc) et l’Iterator\nretourné est utilisé pour boucler sur ses valeurs.\n\n# Consommateurs d'Iterable\n\nLa deuxième bonne nouvelle, c’est que plusieurs concepts du langage tirent avantage de ce protocole :\n\n* Certaines syntaxes s’attendent à recevoir des Iterables\n\n```js\nconst arr = [\"a\", \"b\"]\n\n// La syntaxe à laquelle on pense immédiatement est la syntaxe « for .. of »\n// qui permet de boucler sur les valeurs des Iterables.\nfor (val of arr) {\n    console.log(val)\n}\n\n// Le spread qui permet d'insérer facilement des valeurs dans un Array\n// utilise également des Iterable\n['0', ...arr, '1'] // 0, a, b, 1\n\n// yield nécessite également des Iterable\nfunction* gen(){\n  yield* arr\n}\ngen().next() // { value:\"a\", done:false }\n\n// Le destructuring avec le pattern Array\nconst [x, y] = arr // x = 'a',  y = \"b\"\n```\n\n* Des API acceptent également des Iterables\n\n```js\nconst arr = [\"a\", \"b\", \"b\"]\n\n// Certains constructeurs acceptent des Iterable\n\n// Set et Weakset\nconst set = new Set(arr)\nset.has(\"b\") // true\n// Map et WeakMap\nconst map = new Map(arr.entries()) // Attention, le constructeur attend un ensemble [clé, valeur]\nmap.get(0) // 'a'\n\n\n// Ou encore les API suivants :\n\nArray.from(iterable) // transforme n'importe quel Iterable en Array.\nPromise.all(iterableCollectionDePromises) // n'importe quel Iterable qui contient un ensemble de Promises\nPromise.race(iterableCollectionDePromises) // idem\n```\n\n# Built-in Iterable\n\nTroisième bonne nouvelle, plusieurs objets du langage implémentent déjà ce protocole :\n\n```js\n// évidemment les Array\nconst arr = [\"l\", \"o\", \"l\"]\nfor (v of arr) {\n  console.log(v)\n  // 'l'\n  // 'o'\n  // 'l'\n}\n\n// les String\nconst str = \"lol\"\nfor (v of str) {\n  console.log(v)\n  // 'l'\n  // 'o'\n  // 'l'\n}\n\n// les Map et Set (mais PAS WeakMap et WeakSet)\nconst map = new Map().set('l', 1).set('o', 2)\nfor (v of map) {\n  console.log(v)\n  // [\"l\", 1]\n  // [\"o\", 2]\n}\nconst set = new Set().add('l').add('o')\nfor (v of map) {\n  console.log(v)\n  // 'l'\n  // 'o'\n}\n\n// Les TypedArray que vous utilisez tous les jours\nconst int16 = new Int16Array(2)\nint16[0] = 42\nfor (v of int16) {\n  console.log(v)\n  // 42\n  // 0\n}\n\n// Même l'objet spécial arguments (que vous\n// ne devriez plus utiliser avec l'ES6) est un Iterable\nfunction test() {\n  for (v of arguments) {\n    console.log(v)\n    // 'l'\n    // 'o'\n    // 'l'\n  }\n}\ntest('l', 'o', 'l')\n\n// Les NodeList retournés par l'API DOM également !\nconst matches = document.querySelectorAll('div')\nfor (m of matches) {\n  console.log(m)\n  // <div id=\"topSection\">\n  // <div id=\"brandLogo\">\n  // ...\n}\n```\n\nAutre point : Array, TypedArray, Map, Set sont des Iterable mais définissent\naussi des méthodes qui retournent également des Iterable (ça va, vous suivez\ntoujours ?) :\n\n- entries() retourne un ensemble des clés/valeurs\n- keys() retourne les clés\n- values() retourne les valeurs\n\n```js\nfor (cleVals of arr.entries()) {\n  console.log(cleVals)\n  // [0, \"l\"]\n  // [1, \"o\"]\n  // [2, \"l\"]\n}\n```\n\nDétail important, ``Object`` n'est pas Iterable mais il n'est pas impossible de\nvoir apparaitre dans l'ES7 les méthodes entries(), keys() et values() sur\nObject (cf.\n[la proposition spec](https://github.com/tc39/proposal-object-values-entries)).\n\n# Conclusion\n\nJ’espère que cet article a bien illustré l’importance de ce protocole dans le\nlangage. Nous avons vu ci-dessus que de nombreux concepts du langage tirent\ndéjà avantage de ce protocole mais il est au moins aussi important de noter que\ncela permet d’établir une convention sur laquelle des librairies externes peuvent\ns’appuyer.\n\nElles peuvent le faire de 2 manières :\n\n* en proposant des sources de données qui implémentent le protocole (ex:\nliste chaînée)\n* en tant que consommateur du protocole (ex: un algorithme de tri)\n\n# Un dernier verre pour la route\n\nLes articles suivants vous permettront d'aller encore plus loin dans le sujet. Vous y\napprendrez notamment qu’un iterator peut retourner en option 2 autres méthodes,\nqu’un générateur est à la fois un Iterable et un Iterator, qu’un Iterable peut\nêtre infini ou encore des exemples d’implémentations divers et variés :\n\n* [Iterables and iterators in ECMAScript 6](http://www.2ality.com/2015/02/es6-iteration.html)\n* [Iteration Protocols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols)\n* [ES6 in depth : iterators and the for of loop](https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/)\n* [ES6 iterators in depth](https://ponyfoo.com/articles/es6-iterators-in-depth)\n\nLa pratique restant le meilleur moyen de se former, le site\n[ES6 Katas](http://es6katas.org/) est très bien fait pour s'exercer.\n","raw":"---\ndate: \"2015-12-09\"\ntitle: \"ES6, ES2015 : le protocole d'itération\"\ntags:\n  - javascript\n  - ES6\n  - ES2015\n  - iterators\nauthors:\n  - ffesseler\n---\n\nImaginez un concept si important que si vous l’enleviez du langage, il faudrait\nen conséquence enlever le spread, le destructuring, les générateurs, le for…of\net bien d’autres. Ce concept, introduit dans l’ES6, est en fait un protocole :\nle protocole d’itération.\n\nLe principe est de définir une convention dans le langage, qui permet de\nstandardiser la façon dont des sources de données peuvent être traversées.\n\nPremière bonne nouvelle, ce protocole est assez simple à comprendre et se base\nsur 2 \"interfaces\" (oui les guillemets c’est pour dire qu’on ne parle pas\nd’interface au sens technique, puisqu’elles n’existent pas en JS).\n\nLa première interface, appelée **Iterator** permet à un objet de produire des\nvaleurs en séquence. Un objet est un Iterator lorsqu’il implémente une\nfunction ``next()`` qui retourne un objet avec 2 propriétés :\n\n* ``value``: la valeur courante lors de l'itération\n* ``done`` : un booléen qui indique si on a atteint la fin de l’itération ou non\n\nLes appels successifs à la méthode ``next()`` d’un Iterator permettent donc de\ntraverser et récupérer les valeurs d’un objet. Prenons l’exemple de l’Iterator\nretourné par un Array qui contiendrait 2 valeurs (\"a\" et \"b\") :\n\n```js\niteratorArray.next()\n// -> Object {value: \"a\", done: false}\niteratorArray.next()\n// -> Object {value: \"b\", done: false}\niteratorArray.next()\n// -> Object {value: undefined, done: true}\n```\n\nMais comment récupérer l’Iterator d’un objet vas-tu me dire ? (n’est-ce pas ?)\nÇa tombe bien, c’est le rôle de la seconde interface, appelée **Iterable**. Un\nobjet est Iterable s’il implémente une méthode particulière qui va retourner\nl'Iterator. Cette méthode particulière (appelée *@@iterator* dans la\nspécification) doit être définie en utilisant le symbole ``[Symbol.iterator]``.\n(Les symboles seront expliqués dans un prochain article, pas de panique).\n\nEn reprenant l’exemple précédent, voici comment récupérer l’Iterator d’un Array :\n\n```js\nconst arr = [\"a\", \"b\"]\nconst iteratorArray = arr[Symbol.iterator]()\niteratorArray.next()\n// -> Object {value: \"a\", done: false}\niteratorArray.next()\n// -> Object {value: \"b\", done: false}\niteratorArray.next()\n// -> Object {value: undefined, done: true}\n```\n\nL’exemple ci-dessus illustre donc l’implémentation du protocole par l’Array.\nIl n’est pas très utile en soi, en voici donc un autre qui va permettre de\nboucler sur les valeurs et les afficher :\n\n```js\nconst arr = [\"a\", \"b\"]\nvar iterator = arr[Symbol.iterator]()\n\nvar result = iterator.next()\nwhile (!result.done) {\n  console.log(result.value)\n  result = iterator.next()\n}\n// 'a'\n// 'b'\n```\n\nDe manière générale, quand un objet qui implémente le protocole d’itération est\ntraversé, sa méthode *@@iterator* est appelée (une seule fois donc) et l’Iterator\nretourné est utilisé pour boucler sur ses valeurs.\n\n# Consommateurs d'Iterable\n\nLa deuxième bonne nouvelle, c’est que plusieurs concepts du langage tirent avantage de ce protocole :\n\n* Certaines syntaxes s’attendent à recevoir des Iterables\n\n```js\nconst arr = [\"a\", \"b\"]\n\n// La syntaxe à laquelle on pense immédiatement est la syntaxe « for .. of »\n// qui permet de boucler sur les valeurs des Iterables.\nfor (val of arr) {\n    console.log(val)\n}\n\n// Le spread qui permet d'insérer facilement des valeurs dans un Array\n// utilise également des Iterable\n['0', ...arr, '1'] // 0, a, b, 1\n\n// yield nécessite également des Iterable\nfunction* gen(){\n  yield* arr\n}\ngen().next() // { value:\"a\", done:false }\n\n// Le destructuring avec le pattern Array\nconst [x, y] = arr // x = 'a',  y = \"b\"\n```\n\n* Des API acceptent également des Iterables\n\n```js\nconst arr = [\"a\", \"b\", \"b\"]\n\n// Certains constructeurs acceptent des Iterable\n\n// Set et Weakset\nconst set = new Set(arr)\nset.has(\"b\") // true\n// Map et WeakMap\nconst map = new Map(arr.entries()) // Attention, le constructeur attend un ensemble [clé, valeur]\nmap.get(0) // 'a'\n\n\n// Ou encore les API suivants :\n\nArray.from(iterable) // transforme n'importe quel Iterable en Array.\nPromise.all(iterableCollectionDePromises) // n'importe quel Iterable qui contient un ensemble de Promises\nPromise.race(iterableCollectionDePromises) // idem\n```\n\n# Built-in Iterable\n\nTroisième bonne nouvelle, plusieurs objets du langage implémentent déjà ce protocole :\n\n```js\n// évidemment les Array\nconst arr = [\"l\", \"o\", \"l\"]\nfor (v of arr) {\n  console.log(v)\n  // 'l'\n  // 'o'\n  // 'l'\n}\n\n// les String\nconst str = \"lol\"\nfor (v of str) {\n  console.log(v)\n  // 'l'\n  // 'o'\n  // 'l'\n}\n\n// les Map et Set (mais PAS WeakMap et WeakSet)\nconst map = new Map().set('l', 1).set('o', 2)\nfor (v of map) {\n  console.log(v)\n  // [\"l\", 1]\n  // [\"o\", 2]\n}\nconst set = new Set().add('l').add('o')\nfor (v of map) {\n  console.log(v)\n  // 'l'\n  // 'o'\n}\n\n// Les TypedArray que vous utilisez tous les jours\nconst int16 = new Int16Array(2)\nint16[0] = 42\nfor (v of int16) {\n  console.log(v)\n  // 42\n  // 0\n}\n\n// Même l'objet spécial arguments (que vous\n// ne devriez plus utiliser avec l'ES6) est un Iterable\nfunction test() {\n  for (v of arguments) {\n    console.log(v)\n    // 'l'\n    // 'o'\n    // 'l'\n  }\n}\ntest('l', 'o', 'l')\n\n// Les NodeList retournés par l'API DOM également !\nconst matches = document.querySelectorAll('div')\nfor (m of matches) {\n  console.log(m)\n  // <div id=\"topSection\">\n  // <div id=\"brandLogo\">\n  // ...\n}\n```\n\nAutre point : Array, TypedArray, Map, Set sont des Iterable mais définissent\naussi des méthodes qui retournent également des Iterable (ça va, vous suivez\ntoujours ?) :\n\n- entries() retourne un ensemble des clés/valeurs\n- keys() retourne les clés\n- values() retourne les valeurs\n\n```js\nfor (cleVals of arr.entries()) {\n  console.log(cleVals)\n  // [0, \"l\"]\n  // [1, \"o\"]\n  // [2, \"l\"]\n}\n```\n\nDétail important, ``Object`` n'est pas Iterable mais il n'est pas impossible de\nvoir apparaitre dans l'ES7 les méthodes entries(), keys() et values() sur\nObject (cf.\n[la proposition spec](https://github.com/tc39/proposal-object-values-entries)).\n\n# Conclusion\n\nJ’espère que cet article a bien illustré l’importance de ce protocole dans le\nlangage. Nous avons vu ci-dessus que de nombreux concepts du langage tirent\ndéjà avantage de ce protocole mais il est au moins aussi important de noter que\ncela permet d’établir une convention sur laquelle des librairies externes peuvent\ns’appuyer.\n\nElles peuvent le faire de 2 manières :\n\n* en proposant des sources de données qui implémentent le protocole (ex:\nliste chaînée)\n* en tant que consommateur du protocole (ex: un algorithme de tri)\n\n# Un dernier verre pour la route\n\nLes articles suivants vous permettront d'aller encore plus loin dans le sujet. Vous y\napprendrez notamment qu’un iterator peut retourner en option 2 autres méthodes,\nqu’un générateur est à la fois un Iterable et un Iterator, qu’un Iterable peut\nêtre infini ou encore des exemples d’implémentations divers et variés :\n\n* [Iterables and iterators in ECMAScript 6](http://www.2ality.com/2015/02/es6-iteration.html)\n* [Iteration Protocols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols)\n* [ES6 in depth : iterators and the for of loop](https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/)\n* [ES6 iterators in depth](https://ponyfoo.com/articles/es6-iterators-in-depth)\n\nLa pratique restant le meilleur moyen de se former, le site\n[ES6 Katas](http://es6katas.org/) est très bien fait pour s'exercer.\n","__filename":"fr/articles/js/es2015/iterators.md","__url":"/fr/articles/js/es2015/iterators/","type":"Post"}}}</script><script src="/statinamic-client.js"></script></body></html>